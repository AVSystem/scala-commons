language: scala

scala:
  - 2.11.12
  - 2.12.8

jdk:
  - oraclejdk8

before_install:
  - ./install-redis.sh

env:
  global:
    - REDIS_VERSION=5.0.0
    - REDIS_HOME=$PWD/redis-$REDIS_VERSION/src
    - secure: rFCQMoNWok369gcqif8VttSURcksYPASklNo2OJ2jDBaQAVyiHKgvACSq4/OMGi3uTXzHy0Tsxne//4iLSUfhhzupa39DFhJC4abXw9Xf9WcjE6s+0wQk4j5rFUvwjFCRf/E1jwJsLPJzcMA1lfsFJjQ9l7EjrW8ksxf7ecDRUeSNZe1D/IgjNLZSxI94idtGwLWIqNziMSEJZXz2yYl4b9EhJOlS7f4X2C4p0wDur/aXIcJKadGnNgcD0BwfghQ215/DYmmb3GpOO8D6uHXnTxNwAYRozzRfVwYITFCp3DncuoWP0GB//ukCFPNhQAIaAZvW6KpUHstKP7FjeGxn8HZdHymxiXFydJMR6JK0g/av0T2fINQ4ew3QCs/awp8NoPGp0LC4aUM/FhH2lagjc95AcREWE2WqfI8JDL3sRzRtxMux0Os3NKxElWcfTiicTeHy4wk2CP/v1wDaloZzF7zSZX3PNTlzqb+VpKzRf/3OYvFQnJORPyxtbeYyCdw/OGcIbF3vk+bKxzxSe82WUj38KLeFe+9jmCwb/YpWUSjU1V76feD54VWkSGy7OEs17YKgnS6M/h301u5Sey9sL92pFIYRDpCf1nckzDQcDox1a4bC0H6iiDfRQzHIbl5tVAmlkOkrn8KlNMd5amZAoDWgupnmVv1XQOeNeJCMzU=
    - secure: hSO+R582kfdnM2OX1WLtXGfp6c4EpXvTlUq3BbX0eBcC18q0FXM+tqEEdd95AqHqNBUymShoxzD/fTX4xeaOAHJePG+JAZLIhtJg9T4cknDA5/XPlBNvPHrlB6jBhO/SVtjd93OKFK2f2SbWotBrMrLEbfx90J22bzQFKmS1omtkpOGPZhGiyvYyD5rt46RciYZx8vr/yGj59q+XTzZv3yoNZG3M2WGFFGiJvOdm4Ev09aapFtd0nJRQBQECLfdIaJYb+3SL0USQ6zZtsyHKAd59A8oUFDNAIlm+8Ai/TUwHgbr/wkZmlWxAnkbNceOH5IXovLR9gntwyVDtiM4kCNBz/+X90nOEPMBSQwdHClzvAOQrqvl8W/Nvfft8qcV0K/nJ9ElWxo6po5BjLhB5NLnWCFPYy0ffFnobYk1xvANS5ECYOskFysZBO7PIuLGSfsHxaArF9NIHXqA2I0SmOR4qtCqAQfUWjwWoa1nYpFJk+qsSuULrIs/S/E4psVAq2MW9lZVxRx+OAMoJ4OhTGMbE5uebTYf1OVQmCJS41Z/TA6WfvE9koz4OB9JGjhsVTTUHvMuS2ay/n31oojoTnVMiWjJUwEflGlSJgk+gunvlT6Rd3Wt+EItz64lI0fFVORt05fQ0yUN1ke2Nn+HJpnLDj2q7eb4T4ryWn4xmoBc=
    - secure: rBMOBtO7VaRA0lsQWEqPt6aKglf1GJ9SvKUqNlzDtdby9oISEDwRs3MSogbCPoUQaIMbfGCDVUxTT4mX1U0ADF0bqHMUPXZmJNNWfedh63iebKpt4kYq0TE2h8ruMxGANPp7G9usnxj9fcLMe3V0N3Hm0aEMLmYbMjtDVd5ZTSCgDyTdQRXAho9hB0fQ6S3/FqIBLIn626CiGzhc42VZYwxkPXz4TE5ZVVU/T5oKW3bM7nTjenf8Jq5voOpjUhxeyUZTeehtuJo2GvoT0xYk13DL3/iNpT5AxK5YcnwG6utxAW4CN7nKbEyCJdupxTJpOL7l7WwFpvSfE2bTcNIx3EHqCnk40i0UmubChORA2kAjdmScaBDeGai/5yV/JonFb89uRoNeLrg4kWvij2/IR6in5TGPpwS2wvCtSvOmFW79jLjHvqqQWbaLD9Fqiutu5P0z7gCMLhL4yqPdipc4KeOQR80n6ufPBKVDeUuAUNU2fhn8NeMGTtzBojyNxKBEYHLsmZIIaxOM1vpzTvZbWo9dOue1uc4pPrmywatN6LzVY5UgEAyQNAxsvdu/r0LA9sdsKXps2AaH4WJlpMe3GzPnN+MCHEuxpU6P3qEo6ohMl07tq9XMhKsqxKweX3oFEZLfI401PcX2IcBqnzX42tg7AS69yVh/+BVyb1yT51U=
  matrix:
    - TASK="commons-jvm/test"
    - TASK="commons-js/test"
    - TASK="commons/unidoc"

script:
  - sbt ++$TRAVIS_SCALA_VERSION $TASK

jobs:
  include:
    - stage: deploy
      script: if [ "$TRAVIS_PULL_REQUEST" = 'false' ]; then ./deploy.sh; fi
      if: tag IS present

sudo: false

cache:
  directories:
    - $HOME/.ivy2/cache
    - $HOME/.coursier/cache
    - $HOME/.sbt/boot/
    - $HOME/.sbt/launchers/
    - redis-$REDIS_VERSION

before_cache:
  - find $HOME/.ivy2 -name "ivydata-*.properties" -delete
  - find $HOME/.sbt -name "*.lock" -delete

notifications:
  email:
    - r.janusz@avsystem.com
